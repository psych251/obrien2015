
---
title: "Replication of Study 4 by O'Brien (2015, Journal of Experimental Psychology: General)"
author: "Erik Santoro (esantoro@stanford.edu)"
date: "`r format(Sys.time())`"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: false
---

```{r Load Packages, echo=FALSE}
library(ggplot2)
library(tidyverse) # for data munging
library(knitr) # for kable table formatting
library(ggthemes)
library(sjstats)
library(kableExtra)
sem <- function(x) {sd(x, na.rm=TRUE) / sqrt(sum(!is.na((x))))}
ci <- function(x) {sem(x) * 1.96} # reasonable approximation 

```

##Introduction

Expanding on the findings that people view their past and future selves as others and that people view the future as better and past  as worse, O'Brien(2015) found that people view their past self as more rational and their future self as more emotional. Study 1 revealed this basic finding across a variety of ways of asking people about their past and future selves. Study 2 showed that this is a self-other difference; people did not show the same representations of past or future others as they did of their past and future selves. Study 3 studied one implication: when people role played their past or future self, their preferences changed such that they preferred intellectual enrichment when role playing their future self. Study 4 studied another implication: when people role modeled their past or future self, they were more likely to perform better on tasks that were fun or rational respectively. 

The goal of the replication is to replicate study 4, and specifically replicate the main finding that there was a significant interaction between the self participants role modeled and the task, such that participants role modeling their past self completed more trials than participants role modeling their future self when the task was described as a "fun" task, whereas participants role modeling their future self completed more trials than participants role modeling their past self for a very similar, yet more involved task described as a "self-control" task. This replication will investigate this finding, as the original paper did, both with and without using the three control variables as covariates; the control variables assessed the extent to which participants felt it was difficult to imagine their other self, the level of detail of their other self, and how far away the other self felt.


##Methods

###Power Analysis

The goal is to replicate the main finding, that there was a significant interaction between task (fun and self-control) and role model (past or future self).

The original authors used a MANOVA when looking at one outcome variable (the number of trials completed) and two factors each with two levels (role model -- past or future self; task -- fun or self-control). Given there is one outcome variable, I to use a two-way ANOVA, which I believe is a more appropriate statistical test to use.

In terms of effect size, the original effect size was eta squared = 0.05, or cohen's f of 0.23 (converted partial eta squared to cohen's f using G Power; assumed that partial eta squared and eta squared were equivalent in this case). To achieve an effect size of partial eta squared of 0.05, we would need 152 participants (80% power), 202 participants (90% power), or 249 participants (95% power). The power calculations are below. 80% power is shown below. This sample size is large, given that in my pilot participants took ~ 8 minutes; achieving a power of 80%, we would need to spend ~ $130 (e.g. $0.85 per participant). 


```{r A Priori Power Analysis, echo=FALSE}

include_graphics("screenshots/Apriori_80.png")

```



###Planned Sample

I plan to recruit 150 participants from Amazon's Mechanical Turk. This will give approximately 80% power (79.7%). There will be no specific recruitment parameters in terms of demographics, though I will assess participant demographics.


###Materials

Participants were presented the same materials from the original study, namely 10 different photos in which participants were asked to either enjoy the photos ("fun" task) or do some computational task ("self-control" task). See a screenshot from the original paper.

```{r Materials screenshot, echo=FALSE}

include_graphics("screenshots/Materials.png")

```


###Procedure

The following procedures from the original article were followed precisely. There are some exceptions in the questions asked or how they were asked; see "Differences from Original Study" section.
	
**Excerpts from paper:**

>Participants were randomly assigned into a 2 (task: fun or self-control) x 2 (role model: past or future self) between-subjects design in a study about motivation. For the main part, all participants completed a slideshow task. Participants were told they would view a series of nature photos one by one, and all saw the same photos in the same order. Under each, they were given a choice to “Show me another one!” or “End this slideshow task; move me to the rest of the survey.” It was made clear that participants could go as long as they wished without affecting payment. They were unaware of a ceiling, but the slideshow was capped at 10 before ending automatically (even if they clicked “Show me another one!” at the 10th photo). There were five wildlife photos and five still-life photos. 

>*Task manipulation.* The purpose of the task, however, varied across participants (see Table 1). Some participants thought the task was about enjoyment (fun condition). Specifically, they were instructed: “This task is somewhat boring, but it is designed to assess your capacity for emotionality (i.e., feelings and enjoyment; being reactive). The more photos you choose to click through, the higher your ‘fun’ score.” They were asked to simply look at each photo (e.g., “Look at the stripes on this tiger!”). Under each photo was a text box in which they were instructed to type “ok” after they had “sufficiently enjoyed” it, and under the text box was the choice (i.e., to see another photo or to end the slideshow). The target measure was how many photos participants clicked through before opting out of the slideshow. Other participants thought the task was about critical thinking (self-control condition). They were instructed: “This task is somewhat boring, but it is designed to assess your capacity for rationality (i.e., concentration and thinking skills; being proactive). The more photos you choose to click through, the higher your ‘self-control’ score.” They were asked to make a difficult calculation about the contents in the photo (e.g., “How many stripes do you see on this tiger?”). Under the photo was a text box in which they were instructed to type their actual answer, and under the text box was the choice. Again, the target measure was how many photos they viewed before choosing to move on. Otherwise, the actual slideshow was identical for all participants.

>*Role model manipulation.* Critically, before knowing about or completing the slideshow task, participants completed the very first part of the study. They were asked to reflect on the positive attributes of either their “past self: who you recall being over the	last few years,” or their “future self: who you imagine being over the next few years.” To get into the mind-set, they were asked to write open-ended responses to this prompt: "What do you think are the benefits to feeling connected to your future (past)? When might it actually be good for you to “act like” your future self (past self)? If you brought to mind your future self (past self) as a role model for motivating yourself today, in what types of tasks would that help? What, exactly, is your future self (past self) good at?” After writing, participants were instructed to keep this other self in mind as a guide in performing subsequent tasks in the study (e.g., “Think about what she would motivate you to do, for better or for worse”). At that point, participants were informed about the slideshow task and completed it as described. Finally, at the end of the entire study, participants rated how difficult it was to imagine their other self (1 = very easy to imagine, to 7 = very difficult to imagine), the detail level of the mental image of their other self (1 = not at all detailed, to 7 = very detailed), and how far away their other self seemed (1 = they feel very close to me now, to 7 = they feel very far from me now). 

**Working Replication Link:**

Link: https://stanforduniversity.qualtrics.com/jfe/form/SV_4NQmuXvZK27wPzL

###Analysis Plan

**Overview:**

The **key analysis of interest** is to replicate the significant interaction by task and role model, such that participants completed more trials in the fun task when role modeling their past self and completed more trials in the self-control task when role modeling their future self. 

Importantly, as noted earlier, I plan to analyze the results using a two-way ANOVA. I believe this is the correct statistical test to use (not a MANOVA, as the original paper used) as the goal of the analysis is to look at the interaction between the two categorical factors, task (fun or self-control) and role model (past or future self), on the number of trials completed.


**Relevant Excerpts from Paper:**

>"One participant reported confusion because the photos did not load properly. Excluding this participant does not meaningfully affect the results, so the entire sample was retained. Data were submitted to a univariate MANOVA, with Task and Role Model as fixed factors. Number of trials completed before quitting was the dependent variable. ... Importantly, this effect was qualified by a predicted interaction with role model, F(1, 220) = 12.45, p < .001, eta squared = .05 (see Figure 3). For the fun version of the task, participants motivated by their past self completed more trials (M = 6.90, SD = 3.57) than did participants motivated by their future self (M = 5.03, SD = 3.43), F(1, 220) = 9.95, p = .002, eta squared = .04. However, for the self-control version of the task, future-motivated participants (M = 4.63, SD = 2.97) completed more trials than past-motivated participants (M = 3.45, SD = 2.74), F(1, 220) = 3.52, p = .06, eta squared = .016. ... Importantly, when entering these items as covariates in the model, all results were essentially identical: The critical interaction remained significant, F(1, 217) = 11.45, p = .001, eta squared = .05, as did the reported contrasts for the fun task, F(1, 217) = 8.98, p = .003, eta squared = .04, and for the self-control task, F(1, 217) = 3.35, p = .068, eta squared = .015."


**Analysis Steps**

1) Exclusion: No participants will be excluded in the confirmatory analysis as none were excluded in the original paper (one person in the original study reported confusion with photos loading; however they were not excluded in the original paper as excluding did not change results).

2) Data Cleaning: Summarize the data so that for each participant, their task (fun or self-control), role model (past or future self), number of trials completed (need to summarize), and their responses for the three covariates (difficulty, detail, distance) are included as separate columns. The number of trials will be a range from 1 to 10, and is equal to the number of times the participant selected the option "show me another one" or "end this slideshow"; as O'Brien (2015) notes, this is equal to the number of photos the participant viewed before choosing to end the slideshow. Note that I have clarified this after submitting my pre-registration (there was a typo in which I described that the range would be from 0 to 10, and it would be equal to the number of times "show me another one" was selected).

3) Analysis: Conduct a two-way anova such that find the main effect of task, the main effect of role model, and their interaction on the number of trials. Then, conduct the same two-way anova separately for each of the three covariates: difficulty, detail, and distance from the self that was role modeled.


###Differences from Original Study

There are several slight differences from the original study, as noted below. Since all are minor, none are expected to make a difference on the two confirmatory analyses. 


**Sample differences**

None intended: We are recruiting Amazon Mechanical Turkers, and so there should be the same demographic distribution (e.g. original study had 57.1% women; 79.0% White; M age = 34.09).


**Setting differences**

None to slight: The setting is a Qualtrics survey hosted on Amazon's Mechanical Turk. The one slight difference is that we are paying participants $0.85 for completing the task, whereas the original study paid participants $1.00 per hit.


**Procedure differences**

  Please note that there was one procedure change that I did not pre-register, namely: "I changed from "click continue" to "click the arrow" throughout."

**1. New Questions**
   
* Participants were asked a new control variable: how far away their other self seemed during the task (1 = they felt very close to me then, to 7 = they felt very far from me then).

* Participants were asked a new manipulation check: the extent to which they kept in mind their "other self" as a guide when doing the task (1 = did not keep in mind, 7 = kept in mind).
  
* A measure that logged time spent per photo was added. This will be used for an exploratory hypothesis, which is that participants in the fun condition who role model their past selves will spend more time 'enjoying' the task than participants in the same condition who role model their future selves.  
  
* In demographics, a question was added to assess education levels.
  
  
**2. Question modifications**

* Response questions
      + For the response question in which participants were asked to write 5-10 sentences about their role model, I created a minimum of 250 characters, assuming conservatively 50 characters per question (and in piloting, no one was below this threshold). In the text description of the task, I added
      
      + For the self-control task response questions, in which participants had to do some sort of counting task, I changed it from an essay box to a single line box, and I also required that participants write a number.
      
      + For the fun task response questions, in which participants had to write "ok", I required that participants type in "ok".
    
* Control variables
      + For the question that assessed how far away the self felt from them right now, I bolded the words "does" and "right now".
      
      + I eliminated three control variable questions that were asked in the original survey, but that are not predicted to affect the way in which a participant proceeds through the survey.

  
* Appearance
      + I inserted my own images so that they would load quicker (I set the dimensions to be width = 700 ahead of time)
      
      + I deleted the white space above and below the images so easier to see all at once on one page. I also deleted extra spacing in the intro slide.
    
* Demographics
      + For the gender question, I added "I prefer another term" and phrased as "What gender do you most identify with?"

      + For the ethnicity question, I used different options.
  
      + I did not randomize the question order for demographics, and I made all as "request response" rather than "force response"
      
      + I added the demographics questions after the control variable questions.


**3. Other changes**
  
* I fixed several typos, including: 
      + For the future self condition, I changed the wording from "who you recall being" to "who you imagine being."
      
      + I changed it to "your" not "you're" on page 1.
      
      + I inserted the word "to" in the following phrase: your job is [to] complete a "fun" task.
      
      + For the past fun condition, I changed the end of the phrase to say "want you to quit" from "move onto other things" for the fun conditions
      
      + I inserted the words "was it" in the following phrase: how difficult [was it] to imagine your "other self"
      
      + I changed from "click continue" to "click the arrow" throughout.
      

**Analysis plan differences**

As noted in the "Analysis Plan" section, I conduct a two-way ANOVA rather than a univariate MANOVA as MANOVA's are for two dependent variables typically and there is only one dependent variable.


### Methods Addendum (Post Data Collection)


#### Actual Sample

```{r Import data, echo = FALSE}

d <- read_csv("data/obrien2015_final_December 6, 2017_16.22_numeric_deidentified.csv")

```

```{r Demographics, echo = FALSE}


#Create Dataframe
d.demographics <- d %>%
    filter(!((DistributionChannel == "Distribution Channel") |
           DistributionChannel == "{\"ImportId\":\"distributionChannel\"}")) %>% 
  mutate(subid = row_number()) %>%
  select(subid, condition, sex, Ethnicity, age, Education, Q_TotalDuration) %>%
  mutate(ethnicity_simplified = as.numeric(Ethnicity)) %>%
  mutate(ethnicity_simplified = ifelse(is.na(ethnicity_simplified),9,ethnicity_simplified)) %>% #Using 9 to denote multiple ethnicities selected
  mutate(edu_simplified = as.numeric(Education)) %>%
  mutate(edu_simplified = ifelse(edu_simplified <3,0,1))


#N

d.demographics$subid <- as.numeric(d.demographics$subid)

numberp <- sum(d.demographics$subid>0)
  

#Summarize age

d.demographics$age <- as.numeric(d.demographics$age)

mean_age <- round(mean(d.demographics$age), digits = 1)

sd_age <- round(sd(d.demographics$age), digits = 1)

#Summarize gender

prcnt_female <- round(100*(sum(d.demographics$sex == "2") / numberp),digits = 1)

#Summarize ethnicity

d.demographics$ethnicity_simplified[(d.demographics$ethnicity_simplified==7)] <- "White"

prcnt_white <- round(100*(sum(d.demographics$ethnicity_simplified == "White") / numberp), digits = 1)

#Summarize education


d.demographics$edu_simplified[(d.demographics$edu_simplified==1)] <- "Some college or more"

prcnt_college <- round(100*(sum(d.demographics$edu_simplified == "Some college or more") / numberp), digits = 1)

```
  

```{r Number per Condition, echo = FALSE}

number <- d.demographics %>%
  group_by(condition) %>%
  summarise(n = n()) %>%
  kable(caption = "Participants Per Condition")

```
  
  We collected `r numberp` participants from Amazon's Mechanical Turk. These participants were `r prcnt_female`% women; `r prcnt_white`% White; mean age = `r mean_age` years (SD age = `r sd_age` years); `r prcnt_college`% had some college or more. Of note, these demographics are comparable to the participants recruited in the original study:

>Two hundred twenty-four people (57.1% women; 79.0% White; mean age = 34.09, sd age= 10.58) completed an online task for $1.00 via Amazon’s Mechanical Turk.

  There were no exclusions. Please note that one participant indicated that they had difficulty "counting the boats", but this was the point of the task and so they were not excluded.
  
  Of note, the number of participants per condition was slightly uneven: `r number`. 
  
  While the Qualtrics randomizer worked, many more Mechanical Turkers "accepted" the HIT without completing the HIT (most did not start). Due to random chance, this resulted in a slightly different n per condition. However, there were no differences by age, gender or total time per condition (these analyses are not shown for the sake of brevity), and so no correctional analyses are needed. 


#### Differences from pre-data collection methods plan
  
  There was one difference from the pre-data collection methods plan. The plan was to collect 150 participants, but only 148 participants were collected. While 150 Mechanical Turk workers took HITs, two of the surveys were blank. Since participants were paid within 15 minutes of submitting the HIT, these two blank surveys were not caught until after the participants had been paid. Due to funding reasons and because 148 was approximately 80% power, we decided to keep 148 participants (79% power using original effect size).

##Results

###Data preparation


```{r Data cleaning & filtering, echo=FALSE}

#Filter out first two rows and select relevant variables

d.tidy <- d %>%
  filter(!((DistributionChannel == "Distribution Channel") |
           DistributionChannel == "{\"ImportId\":\"distributionChannel\"}")) %>% 
  mutate(subid = row_number()) %>% #create subject id column
  select(contains("DV"),condition, subid, difficult, detailed, distancenow, distancetask, ManipulationCheck)

```

I created a tidy data set to be used in the confirmatory analysis (and I included covariate variables and manipulation check variable to be used in exploratory analyses):

```{r Tidy data Confirmatory Analysis, echo=FALSE}

#Gather data
d.tidy <- d.tidy %>%
  gather(dv, dvresponse, contains("DV")) %>%
  filter(!is.na(dvresponse))%>% 
  mutate(rolemodel = ifelse(condition == "pastrational","past",
                            ifelse(condition =="pastfun","past","future"))) %>%
  mutate(task = ifelse(condition == "pastrational","selfcontrol",
                            ifelse(condition =="futurerational","selfcontrol","fun"))) #rational is the same as self-control


#Make dv response into a numeric

d.tidy$dvresponse <- as.numeric(d.tidy$dvresponse)

#Summarize by task; we want one line per variable

d.tidy <- d.tidy %>%
  group_by(subid, task, rolemodel, difficult, detailed, distancenow, distancetask, ManipulationCheck) %>%
  summarise(numtrials = sum(((dvresponse == 1) | (dvresponse== 2)), na.rm = TRUE))

 
#Make factor variables

d.tidy$task <- as.factor(d.tidy$task)
d.tidy$rolemodel <- as.factor(d.tidy$rolemodel)
d.tidy$difficult <- as.factor(d.tidy$difficult)
d.tidy$detailed <- as.factor(d.tidy$detailed)
d.tidy$distancenow <- as.factor(d.tidy$distancenow)
d.tidy$distancetask <- as.factor(d.tidy$distancetask)


#Convert number of trials to a numeric variable
d.tidy$numtrials <- as.numeric(d.tidy$numtrials)


#Display data
kable(head(d.tidy), caption = "Tidy Data")




```



I created a summarized data set to be used to plot findings:
```{r Summarized Data, echo=FALSE}

#Summarize data
d.summarized <- d.tidy %>%
  group_by(task, rolemodel) %>%
  summarise(avgtrials = mean(numtrials),
            sem = sem(numtrials),
            n = n())

#re-orders past & future for plot
d.summarized$rolemodel <- factor(d.summarized$rolemodel, levels = rev(levels(d.summarized$rolemodel))) 


#Display data
kable(head(d.summarized),digits = 1, caption = "Summarized Data")
 
```

###Confirmatory analysis

####Graph of Main Finding (Two Way Interaction)

This is the original chart from the paper for the key analysis:

```{r Original Main Chart, out.width="80%", echo = FALSE}

include_graphics("screenshots/MainChart.png")

```

This is my replicated finding:

```{r Main Analysis Chart, echo = FALSE, fig.width=7, fig.height=4.5}

ggplot(data = d.summarized,
       aes(x = task, y = avgtrials, fill = rolemodel)) +
  geom_bar(stat="identity", width = 0.5, position = "dodge", colour = "black") +
  geom_errorbar(aes(ymin = (avgtrials - sem), ymax = (avgtrials + sem)),width = 0.03, position = position_dodge(width = 0.5)) +
  scale_fill_manual(name="",
                    values = c("future" = "grey43","past" = "gray80"), #future is dark grey, past is light grey
                    labels = c("future" = "Motivated by Future Self", "past" = "Motivated by Past Self       ")) +
  scale_x_discrete(labels = c("Fun Task", "Self-Control Task")) +
  scale_y_continuous(breaks = 1:10)+
  coord_cartesian(ylim=c(1,8)) +
  labs(x = "Task Frame", 
       y = "Trials completed (min 1, max 10)",
       caption = "\n  Results of Replication. Mean number of photo trials completed before \nopting to end the slideshow. Error bars are +/- 1 SEM.") +
  ggthemes::theme_few() +
  theme(legend.direction = "horizontal",
        legend.justification = c("right", "top"),
        legend.position = c(0.99,.97),
        legend.text = element_text(size=16),
        plot.caption = element_text(hjust=0.05, vjust=0.1, size = 14),
        axis.text.y = element_text(size=14),
        axis.title.y = element_text(size = 14, face="bold"),
        axis.text.x = element_text(size=17, colour = "black"),
        axis.title.x = element_text(size=14, face = "bold"))


```

  Graphically, it seems that there is not a task by role model interaction. In fact, it seems that the opposite interaction (future self completes more trials on fun task, past self completes more trials on self-control task) is trending.


####Model of Main Finding (Two Way Interaction)

  Let's conduct a two way anova, looking at the number of trials completed comparing task by role model. The main term of interest is the p-value for the task:role model condition; in other words, we want to know whether the task by role model interaction is significant.
```{r Two-Way ANOVA for Num Trials, echo = FALSE}

#Anova
fit <- anova(lm(numtrials ~ task * rolemodel, d.tidy))

kable(fit, digits = 2, caption = "ANOVA output")

```


  This analysis confirmed what we saw in the chart: the interaction was not significant. Moreover, as we saw, there was a main effect by task. Even though the interaction was not significant, and seemed to be in the opposite direction, let's look at the effect size (eta squared).

```{r Effect Sizes, echo = FALSE}

kable(eta_sq(fit), digits = 3, caption = "Eta Squared Values")

```


  This shows that the effect size was near 0. In the original paper, eta squared = 0.05. This again shows that we did not quite replicate the finding.


###Exploratory Analyses

  Please note that I have done only some of the original exploratory analyses I planned, and I have also done several new ones, based on feedback from others.



####Exploratory Analysis #1 -- Poisson Regression

  Let's see if the trial data (count) was normally distributed.

```{r Histogram of Number of Trials, echo=FALSE}

d.tidy.2 <- d.tidy %>%
  mutate(condition = paste(task,rolemodel))


ggplot(d.tidy.2,
       aes(x=numtrials)) +
  geom_histogram(binwidth = 1)+
  labs(y="Number of Participants",
       title = "Histogram of Number of Trials Completed") +
  scale_x_discrete("Number of Trials Completed (1-10)", limits = c(1,2,3,4,5,6,7,8,9,10))+
  ggthemes::theme_few()
 
```


  From this chart, we can see that the number of trials is not normally distributed and has spikes at 1 trial (the minimum) and at 10 trials (the maximum), and there was a slight bump around 3 photos.

  Since this is count data, let's model the interaction with poisson regression (note: zero inflated poisson regression not appropriate as there are not an excess of zeroes in the non-log-transformed data set). Here are the results of the poisson model:

```{r Poisson Regression, echo = FALSE}

#Poisson Regression
summary(poissonmodel <- glm(numtrials ~ task * rolemodel, family = "poisson", d.tidy))

```

 The interaction between task and role model is not significant.


####Exploratory Analysis #2 -- Covariates

What if we tested the same interaction using the different covariates O'Brien (2015) used as well as the new covariate I created, using the poisson model?

  Here is the model using the difficulty imagining the self as a covariate:
  
```{r Covariate Difficulty, echo = FALSE}

poissonmodel_difficultcov <- glm(numtrials ~ task * rolemodel + difficult, family = "poisson", d.tidy)

summary(poissonmodel_difficultcov)

```
  


  Here is the model using the detail of the self as a covariate:
  
```{r Covariate Detailed, echo = FALSE}

poissonmodel_detailedcov <- glm(numtrials ~ task * rolemodel + detailed, family = "poisson", d.tidy)

summary(poissonmodel_detailedcov)

```
  
   
   Here is the model using the distance of the self now as a covariate:
  
```{r Covariate Distance Now, echo = FALSE}

poissonmodel_distancenowcov <- glm(numtrials ~ task * rolemodel + distancenow, family = "poisson", d.tidy)

summary(poissonmodel_distancenowcov)

```
  
   
   Here is the model using the distance of the self during the task (the new covariate) as a covariate:
  
```{r Covariate Distance Task, echo = FALSE}

poissonmodel_distancetaskcov <- glm(numtrials ~ task * rolemodel + distancetask, family = "poisson", d.tidy)

summary(poissonmodel_distancetaskcov)

```
  

   None of the interactions are significant. This shows that regardless of covariate used, the critical interaction was never significant.



####Exploratory Analysis #3 -- Manipulation check

  It might be that this experiment did not "work" because people did not use their past or future self as a role model. Let's see how participants scored on the manipulation check I created. Below, a histogram of participants' scores on the histogram is plotted.

```{r Manipulation Check Distribution, echo = FALSE}

ggplot(data =d.tidy,
       aes(x=ManipulationCheck))+
  geom_histogram(stat="count")+
  labs(y="Number of Participants",
       x = "To what extent did you keep your 'other self' in mind as a guide \nwhen doing the slideshow? (1=did not keep in mind, 7=kept in mind)",
       title = "Histogram of Manipulation Check Scores")+
  ggthemes::theme_few() +
  theme(plot.caption = element_text(hjust=0.05, vjust=0.1, size = 12),
        axis.text.y = element_text(size=14),
        axis.title.y = element_text(size = 14, face="bold"),
        axis.text.x = element_text(size=16, colour = "black"),
        axis.title.x = element_text(size=14))

```

  From this chart, we can see that the majority of participants scored at or above the midpoint. However, I think we really want to look at participants who actually tried to do this experiment. So, let's keep only people who scored a 5 or higher on the manipulation check.

How does this affect our analyses? Let's chart the data.


```{r Creation of Manipulation DataSet, echo = FALSE}

#Create binary data set
d.tidy.manipcheck <- d.tidy %>%
  mutate(keep = ifelse(ManipulationCheck >= 5,1,0)) %>%
  filter(keep != 0)


#Summarize data
d.summarized.manipcheck <- d.tidy.manipcheck %>%
  group_by(task, rolemodel) %>%
  summarise(avgtrials = mean(numtrials),
            ci = ci(numtrials),
            n = n())

#re-orders past & future for plot
d.summarized.manipcheck$rolemodel <- factor(d.summarized.manipcheck$rolemodel, levels = rev(levels(d.summarized.manipcheck$rolemodel))) 


#Chart
ggplot(data = d.summarized.manipcheck,
       aes(x = task, y = avgtrials, fill = rolemodel)) +
  geom_bar(stat="identity", width = 0.5, position = "dodge", colour = "black") +
  geom_errorbar(aes(ymin = (avgtrials - ci), ymax = (avgtrials + ci)),width = 0.07, position = position_dodge(width = 0.5)) +
  scale_fill_manual(name="",
                    values = c("future" = "grey43","past" = "gray80"),
                    labels = c("future" = "Motivated by Future Self", "past" = "Motivated by Past Self     ")) +
  scale_x_discrete(labels = c("Fun Task", "Self-Control Task")) +
  scale_y_continuous(breaks = 1:10)+
  coord_cartesian(ylim=c(1,8)) +
  labs(x = "Task Frame", 
       y = "Trials completed (min 1, max 10)",
       title = "Number of Trials Completed \nby Participants who Passed Manipulation Check",
       caption = "Mean number of photo trials completed before opting \nto end the slideshow. Error bars are 95% confidence intervals.") +
  ggthemes::theme_few() +
  theme(legend.direction = "horizontal",
        legend.justification = c("right", "top"),
        legend.position = c(0.8,.97),
        legend.text = element_text(size=12),
        plot.caption = element_text(hjust=0.05, vjust=0.1, size = 12),
        axis.text.y = element_text(size=14),
        axis.title.y = element_text(size = 14, face="bold"),
        axis.text.x = element_text(size=16, colour = "black"),
        axis.title.x = element_text(size=14))
           
```

  Using the 95% confidence intervals as approximation, there does not appear to be an interaction of task and role model. Again, we observe in the fun task, the opposite, albeit non-significant, trend such that participants motivated by their future self completed more trials than participants motivated by their past self.



####Exploratory Analysis #4 -- Time differences by condition

  One implication of using your past (future) self as a role model for the fun (self-control) task is that you might be more thorough and spend longer on each slide enjoying it (counting) than when you use your future (past) self as a role model.

  Thus, I want to know: how much time did participants spend on each trials before moving on to the next slide or finishing the slideshow (e.g. how much time did they spend looking at each photo)? Below is a histogram of the average time spent per trial.

```{r Time Analysis, echo=FALSE}


#Filter Data

d.tidy.time <- d %>%
  filter(!((DistributionChannel == "Distribution Channel") |
           DistributionChannel == "{\"ImportId\":\"distributionChannel\"}")) %>% 
  mutate(subid = row_number()) %>%
  select(contains("Time_Page Submit"),condition, subid)
  

#Gather Data

d.tidy.time <- d.tidy.time %>%
  gather(image, timesubmit, contains("Time_Page Submit")) %>%
  filter(!is.na(timesubmit)) %>%
  mutate(rolemodel = ifelse(condition == "pastrational","past",
                            ifelse(condition =="pastfun","past","future"))) %>%
  mutate(task = ifelse(condition == "pastrational","selfcontrol",
                            ifelse(condition =="futurerational","selfcontrol","fun"))) 


d.tidy.time$timesubmit <- as.numeric(d.tidy.time$timesubmit)

#Summarize by subid; we want one line per variable

d.tidy.time <- d.tidy.time %>%
  group_by(subid) %>%
  summarise(avgtime = mean(timesubmit))


#Join with d.tidy (which has tasks summarized)

d.tidy.time <- right_join(d.tidy,d.tidy.time)


#Plot Raw data
ggplot(data = d.tidy.time,
       aes(x=avgtime))+
  geom_histogram(binwidth = 5)+
  labs(x="Average time per trial (seconds)",
       y="Number of participants",
       title = "Average Time Spent per Trial")+
  ggthemes::theme_few() +
  theme(plot.caption = element_text(hjust=0.05, vjust=0.1, size = 12),
        axis.text.y = element_text(size=14),
        axis.title.y = element_text(size = 14, face="bold"),
        axis.text.x = element_text(size=16, colour = "black"),
        axis.title.x = element_text(size=14))

```

  The data is clearly not normally distributed. So, let's take the log of the data. Does this normalize the data? The average log time per photo is displayed below


```{r Time Dataframe Creation, echo=FALSE}

#Take log of data
d.tidy.time <- d.tidy.time %>%
  mutate(log10avgtime = log10(avgtime))


ggplot(data = d.tidy.time,
       aes(x=log10avgtime))+
  geom_histogram(binwidth = 0.1)+
  labs(x="Average time per trial (log seconds)",
       y="Number of participants",
       title = "Average Log Time Spent per Trial")+
    ggthemes::theme_few() +
    theme(plot.caption = element_text(hjust=0.05, vjust=0.1, size = 12),
        axis.text.y = element_text(size=14),
        axis.title.y = element_text(size = 14, face="bold"),
        axis.text.x = element_text(size=16, colour = "black"),
        axis.title.x = element_text(size=14))

```

  This data set looks now nearly normally distributed. Thus, let's use a two-way ANOVA on the log transformed data. Let's also still plot the average time spent per page per condition just to see differences.


```{r Time Data Summary, echo=FALSE}

#Summarize data
d.summarized.time <- d.tidy.time %>%
  group_by(task, rolemodel) %>%
  summarise(timeduration = mean(avgtime),
            ci = ci(avgtime),
            n = n())
  

#re-orders past & future for plot
d.summarized.time$rolemodel <- factor(d.summarized.time$rolemodel, levels = rev(levels(d.summarized.time$rolemodel))) 


#Graph the time
ggplot(data = d.summarized.time,
       aes(x = task, y = timeduration, fill = rolemodel)) +
  geom_bar(stat="identity", width = 0.5, position = "dodge", colour = "black") +
  geom_errorbar(aes(ymin = (timeduration - ci), ymax = (timeduration + ci)),width = 0.07, position = position_dodge(width = 0.5)) +
  scale_fill_manual(name="", 
                    values = c("future" = "grey34","past" = "gray69"), #future is dark grey, past is light grey
                    labels = c("future" = "Motivated by Future Self   ", "past" = "Motivated by Past Self      ")) +
  scale_x_discrete(labels = c("Fun Task", "Self-Control Task")) +
  coord_cartesian(ylim=c(10,60)) +
  labs(x = "Task Frame", 
       y = "Average Time Spent Per Trial (seconds)",
       title = "Average Time Spent per Trial (seconds)",
       caption = "\nError bars are 95% confidence intervals.") +
  ggthemes::theme_few() +
  theme(legend.direction = "horizontal",
        legend.justification = c("right", "top"),
        legend.position = c(0.75,0.98),
        legend.text = element_text(size=12),
        plot.caption = element_text(hjust=0.05, vjust=0.1, size = 12),
        axis.text.y = element_text(size=14),
        axis.title.y = element_text(size = 14, face="bold"),
        axis.text.x = element_text(size=16, colour = "black"),
        axis.title.x = element_text(size=14))

#Anova
fit2 <- anova(lm(log10avgtime ~ task * rolemodel, d.tidy.time))

kable(fit2, digits = 2, caption = "Log Time per Trial Two-Way ANOVA")



```

  The interaction is not significant, per the two way anova. Looking visually at the raw means, it seems that participants role modeling their future self spent more time in both tasks, particularly in the self-control task (not-significant but trending); note that these differences are not significant based on the 95% confidence intervals.


## Discussion

### Summary of Replication Attempt

  The goal of this replication was to replicate the original, key finding in study 4 of O'Brien (2015) in which there was a self by task interaction, such that participants who role modeled their past self completed more trials (aka viewed more photos) in the fun task than participants who role modeled their future self, and participants who role modeled their future self completed more trials in the self-control task than participants who role modeled their past self. Although this was not specified ahead of time, a successful replication would have to a significant task by self interaction as well as a comparable effect size. 
  
  I failed to replicate the original result. The task by self interaction was not significant, and the effect size was nearly 0 (eta square d= 0.004, compared to original eta squared = 0.05). Moreover, it seemed like there was a trend in the opposite direction, such that participants role modeling their future self completed more trials in the fun task than those role modeling their past self, and participants role modeling their past self in the self-control task completed more trials in the self-control task than participants role modeling their future self.


### Commentary

**A** The exploratory analyses largely confirmed my confirmatory analysis finding: there was no significant interaction between task and role model, even when I used a poisson regression (as the count data was not normally distributed) (exploratory analysis #1), used the covariates the original authors used and my new covariate (exploratory analysis #2), and excluded participants based off my manipulation check (exploratory analysis #3). Moreover, I tested a new hypothesis: could it be that if you were motivated by the situationally appropriate self (e.g. past self for fun task, future self for self-control task), you would be more thorough and spend more time per trial on average (exploratory analysis #4)? I did not find evidence for this interaction, although it did seem that potentially participants motivated by their future self spent more time on the tasks, particularly the self-control task.
  
**B** What is the implication of the failed replication? The first question is: was there a problem in my design that potentially contributed to a failed replication? There were a number of minor changes, but none that would have influenced the interaction I believe. Indeed, perhaps the biggest difference was that I compensated participants $0.85 for a study from 2+ years ago that was compensated $1.00. However, this difference would only explain an overall decrease in number of trials completed (as seems to the be case, eyeballing the averages), not a change in the interaction of task and role model. Another salient difference was that my task was more demanding as I required participants to type "ok" or submit a numerical response, and I required a minimum number of 250 characters on the response question. This would be problematic if this requirement affected trial completion rates at differential rates across the conditions, and I cannot think of why this would be the case. In all probability, this would have just tired out participants, again contributing to a lower number of trials completed, but would not have affected the interaction.
  
  Of course, the question is then: how are we to make sense of this failed replication? Is it the case that the past self is not viewed as emotional, and the future self is not viewed as rational? One explanation is that these selves were never viewed this way, and the original study was a fluke, though I find this unlikely given the robustness of the other studies in O'Brien (2015). Another explanation is that the definition of these selves have changed, such that past selves are no longer viewed as emotional and future selves are no longer viewed as rational. I also find this unlikely as it has only been a few years, and I captured a similar population. A third explanation is that the task itself -- looking at a slideshow of nature photos -- is only a weak manipulation of perceived emotionality or rationality, such that it is not clear how many slides one's past or future self would view on the fun task, or how many slides one's past or future self would view on the future task. Indeed, this ambiguity perhaps explains the trends in my exploratory analysis #4, in which the future self spent more time per trial on average on both tasks particularly the self-control task: one's future self is rational and would exhibit self-control in terms of the thoroughness of doing the task, not how much of the task is done. Thus, one's future self might do any task more thoroughly and spend more time, whether it be fun or rational; perhaps this would be particularly true of a rational task. Of course, this is speculation about a trending difference, as time differences by condition do not appear to be significant based on the chart. A final explanation is that while one's past self is viewed as emotional and one's future self is viewed as rational, this attribute is not strong enough to make a difference when using these selves as role models. Ultimately then, I believe there should be follow-up work in which the task in question is more thoroughly developed before we can make conclusions about whether using past or future selves as role models does or does not affect behavior.
  
**C** There were no objections or challenges raised by the original author. I want to thank the original author for his incredible support throughout the process.




